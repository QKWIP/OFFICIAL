<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„ÙƒÙ„Ù…Ø§Øª - Ù†Ø³Ø®Ø© Ø§Ù„Ù…ØªØ¬Ø±</title>
    <style>
        :root {
            --glass-bg: rgba(255, 255, 255, 0.08);
            --glass-border: rgba(255, 255, 255, 0.15);
            --text-main: #ffffff;
            --accent-color: #00f2fe;
            --highlight-color: rgba(0, 242, 254, 0.3);
            --found-color: #4ade80;
            --fire-color: #ff4d4d;
            --money-color: #ffd700;
            --radius-main: 20px;
        }

        ::-webkit-scrollbar { width: 0px; background: transparent; }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'SF Pro Display', -apple-system, sans-serif;
            user-select: none;
            scrollbar-width: none;
        }

        body {
            min-height: 100vh;
            background: #050505;
            color: var(--text-main);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px;
            overflow-x: hidden;
            position: relative;
        }

        .animated-bg {
            position: fixed;
            inset: 0;
            z-index: -1;
            background-image: url('https://png.pngtree.com/thumb_back/fw800/background/20231029/pngtree-blurred-bokeh-backdrop-unfocused-abstract-art-gallery-or-art-center-texture-image_13737569.png');
            background-size: cover;
            background-position: center;
            filter: brightness(0.2) saturate(1.2);
            transition: transform 10s linear;
        }

        /* Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø¹Ù„ÙˆÙŠ: Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª ÙˆØ§Ù„Ù…Ø§Ù„ */
        .top-bar {
            width: 100%;
            max-width: 650px;
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            z-index: 10;
        }

        .glass-panel {
            background: var(--glass-bg);
            backdrop-filter: blur(25px);
            border: 1px solid var(--glass-border);
            border-radius: 15px;
            padding: 10px 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex: 1;
        }

        .money-display {
            color: var(--money-color);
            font-weight: 900;
            font-size: 1.1rem;
            gap: 8px;
            box-shadow: inset 0 0 10px rgba(255, 215, 0, 0.1);
        }

        .level-controls {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .level-btn {
            background: var(--accent-color);
            border: none;
            width: 28px;
            height: 28px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #000;
            transition: 0.2s;
        }

        .level-btn:active { transform: scale(0.9); }
        .level-btn:disabled { opacity: 0.2; cursor: not-allowed; }

        /* Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© */
        .power-ups {
            width: 100%;
            max-width: 650px;
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            z-index: 10;
        }

        .power-btn {
            flex: 1;
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 15px;
            padding: 10px;
            color: white;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            font-size: 0.8rem;
            transition: 0.3s;
        }

        .power-btn:active { transform: scale(0.95); }
        .power-btn.hint:hover { border-color: var(--accent-color); }
        .power-btn.fire:hover { border-color: var(--fire-color); }

        .game-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
            width: 100%;
            max-width: 650px;
            z-index: 5;
        }

        /* Ø´Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù„Ø¹Ø¨Ø© */
        .level-indicator {
            text-align: center;
            font-size: 0.9rem;
            font-weight: 700;
            color: var(--accent-color);
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 5px;
            opacity: 0.8;
        }

        .word-grid {
            display: grid;
            background: var(--glass-bg);
            border: 2px solid var(--glass-border);
            border-radius: var(--radius-main);
            padding: 8px;
            gap: 4px;
            touch-action: none;
            box-shadow: 0 20px 40px rgba(0,0,0,0.4);
        }

        .grid-cell {
            aspect-ratio: 1/1;
            display: flex;
            justify-content: center;
            align-items: center;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            font-size: clamp(0.8rem, 4vw, 1.2rem);
            font-weight: 800;
            cursor: pointer;
            transition: all 0.2s;
        }

        .grid-cell.selecting { background: var(--highlight-color); color: var(--accent-color); }
        .grid-cell.found { background: var(--found-color); color: #000; }
        .grid-cell.hinted { background: rgba(255, 215, 0, 0.4); color: white; animation: pulse 1s infinite; }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .word-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            background: var(--glass-bg);
            padding: 12px;
            border-radius: var(--radius-main);
            border: 1px solid var(--glass-border);
            justify-content: center;
        }

        .word-tag {
            padding: 6px 12px;
            background: rgba(255,255,255,0.08);
            border-radius: 10px;
            font-size: 0.85rem;
            border: 1px solid var(--glass-border);
            cursor: pointer;
        }

        .word-tag.found { background: var(--found-color); color: #000; text-decoration: line-through; }

        .overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.92);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
            backdrop-filter: blur(15px);
            padding: 20px;
        }

        .overlay.active { display: flex; }

        .btn-action {
            background: var(--accent-color);
            color: #000;
            border: none;
            padding: 15px 40px;
            border-radius: 15px;
            font-weight: 900;
            cursor: pointer;
            margin-top: 20px;
        }

        .price-tag { font-size: 0.7rem; opacity: 0.8; color: var(--money-color); }
    </style>
</head>
<body>

    <div class="animated-bg" id="bg"></div>

    <div class="top-bar">
        <div class="glass-panel level-controls">
            <button class="level-btn" onclick="changeLevel(-1)" id="prev-btn">â—€</button>
            <span style="font-weight: 900; min-width: 70px; text-align: center;">Ø§Ù„Ù…Ø³ØªÙˆÙ‰ <span id="lvl-num">Ù¡</span></span>
            <button class="level-btn" onclick="changeLevel(1)">â–¶</button>
        </div>
        <div class="glass-panel money-display">
            ğŸª™ <span id="money-count">Ù¥Ù Ù </span>
        </div>
    </div>

    <div class="power-ups">
        <button class="power-btn hint" onclick="requestHint()">
            <span>ğŸ’¡ ØªÙ„Ù…ÙŠØ­</span>
            <span class="price-tag">Ù¥Ù  Ù‚Ø±Ø´</span>
        </button>
        <button class="power-btn fire" onclick="requestFire()">
            <span>ğŸ”¥ Ù†Ø§Ø±</span>
            <span class="price-tag">Ù¡Ù¥Ù  Ù‚Ø±Ø´</span>
        </button>
    </div>

    <div class="game-container">
        <div class="level-indicator">Ù„ØºØ² Ø±Ù‚Ù… <span id="lvl-label">Ù¡</span></div>
        <div class="word-grid" id="grid"></div>
        <div class="word-list" id="word-list"></div>
    </div>

    <div class="overlay" id="help-overlay">
        <h3 id="help-title" style="margin-bottom: 20px;">Ø¹Ù† Ø£ÙŠ ÙƒÙ„Ù…Ø© ØªØ¨Ø­Ø«ØŸ</h3>
        <div id="help-options" class="word-list" style="max-width: 400px;"></div>
        <button class="btn-action" style="background: #555; color: white;" onclick="closeHelp()">Ø¥Ù„ØºØ§Ø¡</button>
    </div>

    <div class="overlay" id="win-overlay">
        <div style="text-align: center;">
            <h2 style="font-size: 3rem; color: var(--accent-color);">Ø¨Ø·Ù„!</h2>
            <p>Ù„Ù‚Ø¯ ÙˆØ¬Ø¯Øª Ø¬Ù…ÙŠØ¹ ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø³ØªÙˆÙ‰ <span id="win-lvl-num">Ù¡</span></p>
            <p style="margin-top: 5px; color: var(--money-color);">+ Ù¥Ù  Ù‚Ø±Ø´ Ù…ÙƒØ§ÙØ£Ø© ğŸª™</p>
            <button class="btn-action" onclick="nextLevel()">Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØ§Ù„ÙŠ</button>
        </div>
    </div>

    <script>
        const allPossibleWords = [
            "Ø¹Ø±Ø´", "Ø³Ù…Ø§Ø¡", "Ø£Ø±Ø¶", "Ø¬Ø¨Ù„", "Ø¨Ø­Ø±", "Ø´Ù…Ø³", "Ù‚Ù…Ø±", "Ù†Ø¬Ù…", "Ù„ÙŠÙ„", "Ù†Ù‡Ø§Ø±",
            "Ø³Ø­Ø§Ø¨", "Ù…Ø·Ø±", "Ø´Ø¬Ø±", "Ø«Ù…Ø±", "Ù†Ù‡Ø±", "Ø¬Ù†Ø§Øª", "ÙÙ„Ùƒ", "Ø­Ø¯ÙŠØ¯", "Ù†ÙˆØ±", "Ø¸Ù„Ù…Ø©",
            "Ø±ÙŠØ§Ø­", "Ø¨Ø±Ø¯", "Ø´Ù‡Ø¨", "Ø¨Ø±ÙˆØ¬", "ÙØ¬Ø±", "Ø¹ØµØ±", "ØªÙŠÙ†", "Ø²ÙŠØªÙˆÙ†", "Ø·ÙˆØ±", "Ø¨Ù„Ø¯"
        ];

        let currentLevel = 1;
        let money = 500;
        let wordsInLevel = [];
        let gridSize = 8;
        let gridData = [];
        let isSelecting = false;
        let startCell = null;
        let selectedCells = [];
        let foundWords = [];
        let helpMode = null;

        function toArabicDigits(num) {
            const id = ['Ù ', 'Ù¡', 'Ù¢', 'Ù£', 'Ù¤', 'Ù¥', 'Ù¦', 'Ù§', 'Ù¨', 'Ù©'];
            return num.toString().replace(/[0-9]/g, w => id[+w]);
        }

        function updateUI() {
            const displayLvl = toArabicDigits(currentLevel);
            document.getElementById('money-count').innerText = toArabicDigits(money);
            document.getElementById('lvl-num').innerText = displayLvl;
            document.getElementById('lvl-label').innerText = displayLvl;
            document.getElementById('prev-btn').disabled = (currentLevel === 1);
        }

        function changeLevel(delta) {
            let newLvl = currentLevel + delta;
            if (newLvl < 1) return;
            currentLevel = newLvl;
            initGame();
        }

        function initGame() {
            const gridElement = document.getElementById('grid');
            const listElement = document.getElementById('word-list');
            
            updateUI();
            const wordCount = 4 + Math.floor(currentLevel / 2);
            gridSize = Math.min(8 + Math.floor(currentLevel / 3), 12);

            gridElement.innerHTML = '';
            listElement.innerHTML = '';
            foundWords = [];
            wordsInLevel = [];
            document.getElementById('win-overlay').classList.remove('active');
            document.getElementById('help-overlay').classList.remove('active');

            let rawWords = [...allPossibleWords].sort(() => Math.random() - 0.5).slice(0, Math.min(wordCount, allPossibleWords.length));
            gridData = Array(gridSize).fill().map(() => Array(gridSize).fill(''));

            rawWords.forEach(word => {
                let placement = placeWord(word);
                if (placement) wordsInLevel.push({ text: word, path: placement });
            });

            const letters = "Ø£Ø¨ØªØ«Ø¬Ø­Ø®Ø¯Ø°Ø±Ø²Ø³Ø´ØµØ¶Ø·Ø¸Ø¹ØºÙÙ‚ÙƒÙ„Ù…Ù†Ù‡ÙˆÙŠ";
            for (let r = 0; r < gridSize; r++) {
                for (let c = 0; c < gridSize; c++) {
                    if (gridData[r][c] === '') {
                        gridData[r][c] = letters[Math.floor(Math.random() * letters.length)];
                    }
                }
            }

            gridElement.style.gridTemplateColumns = `repeat(${gridSize}, 1fr)`;
            gridData.forEach((row, r) => {
                row.forEach((char, c) => {
                    const cell = document.createElement('div');
                    cell.className = 'grid-cell';
                    cell.innerText = char;
                    cell.dataset.r = r;
                    cell.dataset.c = c;
                    
                    const handleStart = (e) => { e.preventDefault(); startSelect(r, c); };
                    const handleMove = (e) => {
                        if (e.type === 'touchmove') {
                            const touch = e.touches[0];
                            const target = document.elementFromPoint(touch.clientX, touch.clientY);
                            if (target && target.dataset.r) moveSelect(parseInt(target.dataset.r), parseInt(target.dataset.c));
                        } else moveSelect(r, c);
                    };

                    cell.addEventListener('mousedown', handleStart);
                    cell.addEventListener('mouseover', handleMove);
                    cell.addEventListener('touchstart', handleStart, {passive: false});
                    cell.addEventListener('touchmove', handleMove, {passive: false});
                    gridElement.appendChild(cell);
                });
            });

            wordsInLevel.forEach(w => {
                const tag = document.createElement('div');
                tag.className = 'word-tag';
                tag.id = `tag-${w.text}`;
                tag.innerText = w.text;
                listElement.appendChild(tag);
            });
        }

        function placeWord(word) {
            const directions = [[0,1],[0,-1],[1,0],[-1,0],[1,1],[-1,-1],[1,-1],[-1,1]];
            let attempts = 0;
            while (attempts < 200) {
                const dir = directions[Math.floor(Math.random() * directions.length)];
                const r = Math.floor(Math.random() * gridSize);
                const c = Math.floor(Math.random() * gridSize);
                
                let path = [];
                let canPlace = true;
                for (let i = 0; i < word.length; i++) {
                    const currR = r + (i * dir[0]);
                    const currC = c + (i * dir[1]);
                    if (currR < 0 || currR >= gridSize || currC < 0 || currC >= gridSize || 
                       (gridData[currR][currC] !== '' && gridData[currR][currC] !== word[i])) {
                        canPlace = false; break;
                    }
                    path.push({r: currR, c: currC});
                }

                if (canPlace) {
                    path.forEach((pos, i) => gridData[pos.r][pos.c] = word[i]);
                    return path;
                }
                attempts++;
            }
            return null;
        }

        function startSelect(r, c) { isSelecting = true; startCell = {r,c}; clearSelecting(); addSelected(r,c); }
        function moveSelect(r, c) {
            if (!isSelecting || !startCell) return;
            const dr = r - startCell.r, dc = c - startCell.c;
            const absDr = Math.abs(dr), absDc = Math.abs(dc);
            let fDr = 0, fDc = 0;
            if (absDr > 0 && absDc === 0) fDr = Math.sign(dr);
            else if (absDr === 0 && absDc > 0) fDc = Math.sign(dc);
            else if (Math.abs(absDr - absDc) < 2) { fDr = Math.sign(dr); fDc = Math.sign(dc); }
            else return;

            clearSelecting(); selectedCells = [];
            const steps = Math.max(absDr, absDc);
            for (let i = 0; i <= steps; i++) {
                addSelected(startCell.r + (i * fDr), startCell.c + (i * fDc));
            }
        }
        function addSelected(r, c) {
            const cell = document.querySelector(`.grid-cell[data-r="${r}"][data-c="${c}"]`);
            if (cell && !selectedCells.includes(cell)) { cell.classList.add('selecting'); selectedCells.push(cell); }
        }
        function clearSelecting() { document.querySelectorAll('.grid-cell.selecting').forEach(el => el.classList.remove('selecting')); }
        
        function endSelect() {
            if (!isSelecting) return;
            isSelecting = false;
            const str = selectedCells.map(c => c.innerText).join('');
            const rev = str.split('').reverse().join('');
            let match = wordsInLevel.find(w => (str === w.text || rev === w.text) && !foundWords.includes(w.text));

            if (match) {
                selectedCells.forEach(c => { c.classList.remove('selecting', 'hinted'); c.classList.add('found'); });
                markWordFound(match.text);
            } else clearSelecting();
            selectedCells = [];
        }

        function markWordFound(wordText) {
            if (foundWords.includes(wordText)) return;
            foundWords.push(wordText);
            document.getElementById(`tag-${wordText}`).classList.add('found');
            if (foundWords.length === wordsInLevel.length) {
                money += 50;
                document.getElementById('win-lvl-num').innerText = toArabicDigits(currentLevel);
                updateUI();
                setTimeout(() => document.getElementById('win-overlay').classList.add('active'), 500);
            }
        }

        function requestHint() { if (money >= 50) showHelpMenu('hint'); else alert("Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ù‚Ø±ÙˆØ´ ÙƒØ§ÙÙŠØ©!"); }
        function requestFire() { if (money >= 150) showHelpMenu('fire'); else alert("Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ù‚Ø±ÙˆØ´ ÙƒØ§ÙÙŠØ©!"); }

        function showHelpMenu(type) {
            helpMode = type;
            const overlay = document.getElementById('help-overlay');
            const options = document.getElementById('help-options');
            const title = document.getElementById('help-title');
            
            title.innerText = type === 'hint' ? "Ø£ÙŠ ÙƒÙ„Ù…Ø© ØªØ±ÙŠØ¯ ØªÙ„Ù…ÙŠØ­Ø§Ù‹ Ù„Ù‡Ø§ØŸ" : "Ø£ÙŠ ÙƒÙ„Ù…Ø© ØªØ±ÙŠØ¯ Ø­Ø±Ù‚Ù‡Ø§ØŸ";
            options.innerHTML = '';
            
            wordsInLevel.filter(w => !foundWords.includes(w.text)).forEach(w => {
                const btn = document.createElement('div');
                btn.className = 'word-tag';
                btn.innerText = w.text;
                btn.onclick = () => applyHelp(w);
                options.appendChild(btn);
            });
            overlay.classList.add('active');
        }

        function applyHelp(wordObj) {
            closeHelp();
            if (helpMode === 'hint') {
                money -= 50;
                const randomPos = wordObj.path[Math.floor(Math.random() * wordObj.path.length)];
                const cell = document.querySelector(`.grid-cell[data-r="${randomPos.r}"][data-c="${randomPos.c}"]`);
                cell.classList.add('hinted');
            } else if (helpMode === 'fire') {
                money -= 150;
                wordObj.path.forEach(pos => {
                    const cell = document.querySelector(`.grid-cell[data-r="${pos.r}"][data-c="${pos.c}"]`);
                    cell.classList.remove('hinted');
                    cell.classList.add('found');
                });
                markWordFound(wordObj.text);
            }
            updateUI();
        }

        function closeHelp() { document.getElementById('help-overlay').classList.remove('active'); }
        function nextLevel() { currentLevel++; initGame(); }

        let moveX = 0;
        setInterval(() => {
            moveX += 0.04;
            const bg = document.getElementById('bg');
            if (bg) bg.style.transform = `scale(1.15) translateX(${Math.sin(moveX) * 15}px)`;
        }, 50);

        window.addEventListener('mouseup', endSelect);
        window.addEventListener('touchend', endSelect);
        window.onload = initGame;
    </script>
</body>
</html>
